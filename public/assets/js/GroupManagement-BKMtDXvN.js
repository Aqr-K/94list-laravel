import"./base-sonieuUH.js";import{v as L}from"./el-loading-DqZh-wdt.js";import{E as H}from"./el-pagination-rqD1yhvC.js";import{E as q}from"./el-input-CfnbBfaI.js";import"./el-tag-D4crlrEn.js";import"./el-select-BOuFmw6D.js";import{E as J,a as K}from"./el-table-column-CCkEx7ov.js";import{E as O}from"./el-input-number-Dil5R9Xz.js";import{E as P}from"./el-button-DDufFYF5.js";import{aa as $,d as R,aM as Q,aN as W,r as _,o as C,e as U,f as a,a as t,k as m,w as g,E as M,O as X,c as Y,i as B,t as k,a4 as z,n as A,F as Z}from"./index-B8pW1vfL.js";import{E as ee}from"./el-overlay-D-CosnQY.js";import{E as te,a as ae}from"./el-form-item-gk2EoJqp.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-24Q8zd9x.js";import"./use-form-item-CJFbIM6h.js";import"./focus-trap-Cx3G5mYf.js";import"./AdminView-BtWSCJBc.js";import"./el-card-DSxRm4_o.js";import"./user-BMVG4AFv.js";import"./vnode-CTXkDMm_.js";import"./scroll-uoENNN5t.js";const oe=o=>$.post("/admin/group",o),ne=o=>$.get(`/admin/group?page=${o.page}&size=${o.size}`),ue=o=>$.patch(`/admin/group/${o.id}`,o),se=o=>$.delete(`/admin/group/${o.id}`),de=o=>$.delete("/admin/group",{data:{group_ids:o}}),re=R({__name:"AddGroup",props:{modelValue:{},modelModifiers:{}},emits:Q(["getGroups"],["update:modelValue"]),setup(o,{emit:d}){const G=d,v=W(o,"modelValue"),y=_(!1),u=_({name:"",count:0,size:0}),r=_(null),S={name:[{required:!0,message:"请输入组名",trigger:"blur"}],count:[{required:!0,message:"请输入可解析个数",trigger:"blur"}],size:[{required:!0,message:"请输入可解析大小",trigger:"blur"}]},x=async V=>{if(!(!V||!await V.validate()))try{y.value=!0,await oe(u.value),M.success("添加成功")}finally{y.value=!1}},F=V=>{G("getGroups"),V()},D=()=>{v.value=!1,G("getGroups")};return(V,n)=>{const b=q,E=te,l=O,i=ae,c=P,p=ee,N=L;return C(),U(p,{title:"添加用户组",width:"60%",modelValue:v.value,"onUpdate:modelValue":n[5]||(n[5]=s=>v.value=s),"before-close":F},{footer:a(()=>[t(c,{type:"info",onClick:n[3]||(n[3]=s=>D())},{default:a(()=>[m("取消")]),_:1}),t(c,{type:"primary",onClick:n[4]||(n[4]=s=>x(r.value))},{default:a(()=>[m("添加")]),_:1})]),default:a(()=>[g((C(),U(i,{ref_key:"addGroupFormRef",ref:r,model:u.value,rules:S,"label-width":"auto"},{default:a(()=>[t(E,{label:"组名",prop:"name"},{default:a(()=>[t(b,{modelValue:u.value.name,"onUpdate:modelValue":n[0]||(n[0]=s=>u.value.name=s)},null,8,["modelValue"])]),_:1}),t(E,{label:"可解析个数",prop:"count"},{default:a(()=>[t(l,{modelValue:u.value.count,"onUpdate:modelValue":n[1]||(n[1]=s=>u.value.count=s)},null,8,["modelValue"])]),_:1}),t(E,{label:"可解析大小",prop:"size"},{default:a(()=>[t(l,{modelValue:u.value.size,"onUpdate:modelValue":n[2]||(n[2]=s=>u.value.size=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[N,y.value]])]),_:1},8,["modelValue"])}}}),ie=R({__name:"GroupManagement",setup(o){const d=_(!1),G=_(15),v=_(1),y=_(),u=_([]),r=async()=>{try{d.value=!0;const l=await ne({page:v.value,size:G.value});y.value=l.data}finally{d.value=!1}},S=async l=>{l.edit=!(l.edit??!1)},x=async l=>{l.edit=!(l.edit??!0),await F(l)},F=async l=>{try{d.value=!0,await ue(l),M.success("修改用户组成功")}finally{d.value=!1,await r()}},D=async l=>{try{d.value=!0,await se(l),M.success("删除用户组成功")}finally{d.value=!1,await r()}},V=async()=>{try{d.value=!0;const l=u.value.map(i=>i.id);await de(l),M.success("批量删除用户组成功")}finally{d.value=!1,await r()}},n=l=>u.value=l;X(r);const b=_(!1),E=()=>b.value=!b.value;return(l,i)=>{var I,w;const c=P,p=J,N=q,s=O,T=K,h=H,j=L;return C(),Y(Z,null,[t(re,{onGetGroups:r,modelValue:b.value,"onUpdate:modelValue":i[0]||(i[0]=e=>b.value=e)},null,8,["modelValue"]),t(c,{type:"primary",onClick:r},{default:a(()=>[m("刷新列表")]),_:1}),t(c,{type:"primary",onClick:E},{default:a(()=>[m("添加用户组")]),_:1}),t(c,{type:"danger",disabled:u.value.length<=0,onClick:V},{default:a(()=>[m(" 批量删除 ")]),_:1},8,["disabled"]),g((C(),U(T,{data:((I=y.value)==null?void 0:I.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:n},{default:a(()=>[t(p,{type:"selection",width:"40"}),t(p,{prop:"id",label:"ID"}),t(p,{prop:"name",label:"组名"},{default:a(({row:e})=>[g(B("span",null,k(e.name),513),[[z,!e.edit]]),g(t(N,{modelValue:e.name,"onUpdate:modelValue":f=>e.name=f},null,8,["modelValue","onUpdate:modelValue"]),[[z,e.edit]])]),_:1}),t(p,{prop:"count",label:"可解析次数"},{default:a(({row:e})=>[g(B("span",null,k(e.count),513),[[z,!e.edit]]),g(t(s,{modelValue:e.count,"onUpdate:modelValue":f=>e.count=f},null,8,["modelValue","onUpdate:modelValue"]),[[z,e.edit]])]),_:1}),t(p,{prop:"size",label:"可解析大小"},{default:a(({row:e})=>[g(B("span",null,k(e.size),513),[[z,!e.edit]]),g(t(s,{modelValue:e.size,"onUpdate:modelValue":f=>e.size=f},null,8,["modelValue","onUpdate:modelValue"]),[[z,e.edit]])]),_:1}),t(p,{prop:"created_at",label:"创建时间"},{default:a(({row:e})=>[m(k(new Date(e.created_at).toLocaleString()),1)]),_:1}),t(p,{prop:"updated_at",label:"更新时间"},{default:a(({row:e})=>[m(k(new Date(e.updated_at).toLocaleString()),1)]),_:1}),t(p,{width:"150",label:"操作",fixed:"right"},{default:a(({row:e})=>[e.edit?A("",!0):(C(),U(c,{key:0,size:"small",type:"primary",onClick:f=>S(e)},{default:a(()=>[m(" 编辑 ")]),_:2},1032,["onClick"])),e.edit?(C(),U(c,{key:1,size:"small",type:"primary",onClick:f=>x(e)},{default:a(()=>[m(" 保存 ")]),_:2},1032,["onClick"])):A("",!0),t(c,{size:"small",type:"danger",onClick:f=>D(e)},{default:a(()=>[m("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[j,d.value]]),t(h,{"current-page":v.value,"onUpdate:currentPage":i[1]||(i[1]=e=>v.value=e),"page-size":G.value,"onUpdate:pageSize":i[2]||(i[2]=e=>G.value=e),"page-sizes":[15,30,50,100],total:((w=y.value)==null?void 0:w.total)??100,layout:"sizes, prev, pager, next",onSizeChange:r,onCurrentChange:r},null,8,["current-page","page-size","total"])],64)}}}),De=le(ie,[["__scopeId","data-v-f6a3ee04"]]);export{De as default};
