import"./base-ByW8jBp4.js";import{E as j}from"./el-card-COj0nMSe.js";import{E as P,a as U}from"./el-table-column-D5MYk5uD.js";import"./el-tag-CyG4v3_J.js";import{E as z}from"./el-space-cL3AIj7Z.js";import{E as I}from"./el-button-Dx7S_srm.js";import{x as M,aj as H,d as v,B as J,N as K,o as f,c as $,e as b,f as t,a8 as Q,u as i,Q as R,n as k,H as w,W as S,J as W,a5 as q,ag as D,r as G,a,k as u,t as O,i as X,aa as Y,j as Z,E as _}from"./index-CUfiTvNe.js";import{u as x}from"./aria2Store-Ca0cXILc.js";import{u as ee}from"./fileListStore-DkGhdaan.js";import{c as B}from"./copy-ByZDDYAU.js";import"./index-CdeJMTo1.js";import"./use-form-item-JWbWLwGP.js";import"./focus-trap-BR415BmJ.js";import"./vnode-D1LQOBIi.js";const ae=M({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:H}}),te={click:r=>r instanceof MouseEvent},oe=["href","target"],se=v({name:"ElLink"}),ne=v({...se,props:ae,emits:te,setup(r,{emit:c}){const n=r,o=J("link"),y=K(()=>[o.b(),o.m(n.type),o.is("disabled",n.disabled),o.is("underline",n.underline&&!n.disabled)]);function g(e){n.disabled||c("click",e)}return(e,h)=>(f(),$("a",{class:w(i(y)),href:e.disabled||!e.href?void 0:e.href,target:e.disabled||!e.href?void 0:e.target,onClick:g},[e.icon?(f(),b(i(R),{key:0},{default:t(()=>[(f(),b(Q(e.icon)))]),_:1})):k("v-if",!0),e.$slots.default?(f(),$("span",{key:1,class:w(i(o).e("inner"))},[S(e.$slots,"default")],2)):k("v-if",!0),e.$slots.icon?S(e.$slots,"icon",{key:2}):k("v-if",!0)],10,oe))}});var le=W(ne,[["__file","link.vue"]]);const ie=q(le),re=r=>new Promise(c=>setTimeout(c,r)),ce=X("h2",null,"链接列表",-1),$e=v({__name:"DownloadLinks",setup(r){const c=ee(),{downloadLinks:n}=D(c),o=G([]),y=s=>o.value=s,g=x(),{aria2ConfigForm:e,aria2ConfigDialogVisible:h}=D(g),C=async s=>{try{await Y.post(`${e.value.host}:${e.value.port}/jsonrpc`,{jsonrpc:"2.0",id:Z(),method:"aria2.addUri",params:[`token:${e.value.token}`,[s.url],{out:s.filename,header:[`User-Agent: ${s.ua}`]}]})}catch{return _.error("发送失败, 请检查控制台输出, 自行谷歌搜索或提交issue")}_.success(`已把${s.filename}任务发送给下载器`)},A=async()=>{_.error("请确保最大同时下载文件数在5及以下,否则可能出现下载失败!"),await re(3e3),_.success("开始下载"),o.value.forEach(s=>C(s))},L=()=>h.value=!0;return(s,d)=>{const m=I,N=z,p=P,F=ie,T=U,V=j;return i(n).length!==0?(f(),b(V,{key:0,class:"card"},{default:t(()=>[ce,a(N,null,{default:t(()=>[a(m,{type:"primary",disabled:o.value.length<=0,onClick:d[0]||(d[0]=l=>A())},{default:t(()=>[u(" 批量下载 ")]),_:1},8,["disabled"]),a(m,{type:"primary",onClick:d[1]||(d[1]=l=>L())},{default:t(()=>[u("下载配置")]),_:1})]),_:1}),a(T,{border:"","show-overflow-tooltip":"",class:"table",data:i(n),onSelectionChange:y},{default:t(()=>[a(p,{type:"selection",width:"40"}),a(p,{prop:"ua",label:"UA"},{default:t(({row:l})=>[a(F,{type:"danger",onClick:E=>i(B)(l.ua,"已复制UA")},{default:t(()=>[u(O(l.ua),1)]),_:2},1032,["onClick"])]),_:1}),a(p,{prop:"filename",label:"文件名"}),a(p,{prop:"url",label:"下载链接"}),a(p,{label:"操作",width:"190"},{default:t(({row:l})=>[a(m,{type:"primary",size:"small",onClick:E=>i(B)(l.url,"已将链接复制到粘贴板内")},{default:t(()=>[u(" 复制链接 ")]),_:2},1032,["onClick"]),a(m,{type:"primary",size:"small",onClick:E=>C(l)},{default:t(()=>[u(" 发送Aria2 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})):k("",!0)}}});export{$e as default};
