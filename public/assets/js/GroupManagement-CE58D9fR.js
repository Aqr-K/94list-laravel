import"./base-ByW8jBp4.js";import{v as A}from"./el-loading-DZ7aAvs5.js";import{E as H}from"./el-pagination-DRYEESqE.js";import{E as q}from"./el-input-Cfcxms0_.js";import"./el-tag-CyG4v3_J.js";import"./el-select-CAn2VAbz.js";import{E as J,a as Q}from"./el-table-column-D5MYk5uD.js";import{E as O}from"./el-input-number-D7-Cx9Kw.js";import{E as P}from"./el-button-Dx7S_srm.js";import{aa as U,d as R,aK as W,aL as X,r as f,o as C,e as $,f as a,a as t,k as m,w as g,E as M,O as Y,c as Z,i as I,t as k,a4 as z,n as w,F as h}from"./index-CUfiTvNe.js";import{E as ee}from"./el-overlay-Bl4m9Rs6.js";import{E as te,a as ae}from"./el-form-item-Dlr1zLGR.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CdeJMTo1.js";import"./use-form-item-JWbWLwGP.js";import"./focus-trap-BR415BmJ.js";import"./AdminView-DMGJXvqy.js";import"./el-card-COj0nMSe.js";import"./user-BllPEY18.js";import"./vnode-D1LQOBIi.js";import"./scroll-CFEWovNJ.js";const oe=n=>U.post("/admin/group",n),ne=n=>U.get(`/admin/group?page=${n.page}&size=${n.size}`),ue=n=>U.patch(`/admin/group/${n.id}`,n),se=n=>U.delete("/admin/group",{data:{group_ids:[n.id]}}),de=n=>U.delete("/admin/group",{data:{group_ids:n}}),re=R({__name:"AddGroup",props:{modelValue:{},modelModifiers:{}},emits:W(["getGroups"],["update:modelValue"]),setup(n,{emit:r}){const G=r,v=X(n,"modelValue"),y=f(!1),s=f({name:"",count:0,size:0}),i=f(null),S={name:[{required:!0,message:"请输入组名",trigger:"blur"}],count:[{required:!0,message:"请输入可解析个数",trigger:"blur"}],size:[{required:!0,message:"请输入可解析大小",trigger:"blur"}]},x=async V=>{if(!(!V||!await V.validate()))try{y.value=!0,await oe(s.value),M.success("添加成功")}finally{y.value=!1}},F=V=>{G("getGroups"),V()},D=()=>{v.value=!1,G("getGroups")};return(V,u)=>{const b=q,E=te,l=O,o=ae,c=P,p=ee,B=A;return C(),$(p,{title:"添加用户组",width:"60%",modelValue:v.value,"onUpdate:modelValue":u[5]||(u[5]=d=>v.value=d),"before-close":F},{footer:a(()=>[t(c,{type:"info",onClick:u[3]||(u[3]=d=>D())},{default:a(()=>[m("取消")]),_:1}),t(c,{type:"primary",onClick:u[4]||(u[4]=d=>x(i.value))},{default:a(()=>[m("添加")]),_:1})]),default:a(()=>[g((C(),$(o,{ref_key:"addGroupFormRef",ref:i,model:s.value,rules:S,"label-width":"auto"},{default:a(()=>[t(E,{label:"组名",prop:"name"},{default:a(()=>[t(b,{modelValue:s.value.name,"onUpdate:modelValue":u[0]||(u[0]=d=>s.value.name=d)},null,8,["modelValue"])]),_:1}),t(E,{label:"可解析个数",prop:"count"},{default:a(()=>[t(l,{modelValue:s.value.count,"onUpdate:modelValue":u[1]||(u[1]=d=>s.value.count=d)},null,8,["modelValue"])]),_:1}),t(E,{label:"可解析大小",prop:"size"},{default:a(()=>[t(l,{modelValue:s.value.size,"onUpdate:modelValue":u[2]||(u[2]=d=>s.value.size=d)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[B,y.value]])]),_:1},8,["modelValue"])}}}),ie=R({__name:"GroupManagement",setup(n){const r=f(!1),G=f(15),v=f(1),y=f(),s=f([]),i=async()=>{try{r.value=!0;const l=await ne({page:v.value,size:G.value});y.value=l.data}finally{r.value=!1}},S=async l=>{l.edit=!(l.edit??!1)},x=async l=>{l.edit=!(l.edit??!0),await F(l)},F=async l=>{try{r.value=!0,await ue(l),M.success("修改用户组成功")}finally{r.value=!1,await i()}},D=async l=>{try{r.value=!0,await se(l),M.success("删除用户组成功")}finally{r.value=!1,await i()}},V=async()=>{try{r.value=!0;const l=s.value.map(o=>o.id);await de(l),M.success("批量删除用户组成功")}finally{r.value=!1,await i()}},u=l=>s.value=l;Y(i);const b=f(!1),E=()=>b.value=!b.value;return(l,o)=>{var L,N;const c=P,p=J,B=q,d=O,T=Q,K=H,j=A;return C(),Z(h,null,[t(re,{onGetGroups:i,modelValue:b.value,"onUpdate:modelValue":o[0]||(o[0]=e=>b.value=e)},null,8,["modelValue"]),t(c,{type:"primary",onClick:o[1]||(o[1]=e=>i())},{default:a(()=>[m("刷新列表")]),_:1}),t(c,{type:"primary",onClick:o[2]||(o[2]=e=>E())},{default:a(()=>[m("添加用户组")]),_:1}),t(c,{type:"danger",disabled:s.value.length<=0,onClick:o[3]||(o[3]=e=>V())},{default:a(()=>[m(" 批量删除 ")]),_:1},8,["disabled"]),g((C(),$(T,{data:((L=y.value)==null?void 0:L.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:u},{default:a(()=>[t(p,{type:"selection",width:"40"}),t(p,{prop:"id",label:"ID"}),t(p,{prop:"name",label:"组名"},{default:a(({row:e})=>[g(I("span",null,k(e.name),513),[[z,!e.edit]]),g(t(B,{modelValue:e.name,"onUpdate:modelValue":_=>e.name=_},null,8,["modelValue","onUpdate:modelValue"]),[[z,e.edit]])]),_:1}),t(p,{prop:"count",label:"可解析次数"},{default:a(({row:e})=>[g(I("span",null,k(e.count),513),[[z,!e.edit]]),g(t(d,{modelValue:e.count,"onUpdate:modelValue":_=>e.count=_},null,8,["modelValue","onUpdate:modelValue"]),[[z,e.edit]])]),_:1}),t(p,{prop:"size",label:"可解析大小"},{default:a(({row:e})=>[g(I("span",null,k(e.size),513),[[z,!e.edit]]),g(t(d,{modelValue:e.size,"onUpdate:modelValue":_=>e.size=_},null,8,["modelValue","onUpdate:modelValue"]),[[z,e.edit]])]),_:1}),t(p,{prop:"created_at",label:"创建时间"},{default:a(({row:e})=>[m(k(new Date(e.created_at).toLocaleString()),1)]),_:1}),t(p,{prop:"updated_at",label:"更新时间"},{default:a(({row:e})=>[m(k(new Date(e.updated_at).toLocaleString()),1)]),_:1}),t(p,{width:"150",label:"操作",fixed:"right"},{default:a(({row:e})=>[e.edit?w("",!0):(C(),$(c,{key:0,size:"small",type:"primary",onClick:_=>S(e)},{default:a(()=>[m(" 编辑 ")]),_:2},1032,["onClick"])),e.edit?(C(),$(c,{key:1,size:"small",type:"primary",onClick:_=>x(e)},{default:a(()=>[m(" 保存 ")]),_:2},1032,["onClick"])):w("",!0),t(c,{size:"small",type:"danger",onClick:_=>D(e)},{default:a(()=>[m("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[j,r.value]]),t(K,{"current-page":v.value,"onUpdate:currentPage":o[4]||(o[4]=e=>v.value=e),"page-size":G.value,"onUpdate:pageSize":o[5]||(o[5]=e=>G.value=e),"page-sizes":[15,30,50,100],total:((N=y.value)==null?void 0:N.total)??100,layout:"sizes, prev, pager, next",onSizeChange:i,onCurrentChange:i},null,8,["current-page","page-size","total"])],64)}}}),De=le(ie,[["__scopeId","data-v-0ec54341"]]);export{De as default};
