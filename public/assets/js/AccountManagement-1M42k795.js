import{b as J,$ as ee,a0 as te,r as g,e as r,c as y,m as t,k as l,x as c,w as H,E as v,G as ae,z as le,y as ne,B as oe,A as K,O as se,v as Q,o as ce,j as B,q as L,t as f,u as R,C as h,F as j,_ as ue,S as ie,I as de,J as pe,U as re,a2 as _e}from"./.pnpm-DQd76FlD.js";import{i as k}from"./index-CY8zHUnN.js";import{f as q}from"./format-DaCfCw6f.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";const fe=o=>k.post("/admin/account",o),ve=o=>k.get(`/admin/account?page=${o.page}&size=${o.size}`),ye=o=>k.patch(`/admin/account/${o.id}`,o),ge=o=>k.patch("/admin/account/info",{account_ids:[o.id]}),ke=o=>k.patch("/admin/account/info",{account_ids:o}),Ae=o=>k.delete("/admin/account",{data:{account_ids:[o.id]}}),be=o=>k.delete("/admin/account",{data:{account_ids:o}}),G=o=>k.patch("/admin/account/switch",{account_ids:[o.account.id],switch:o.switch}),O=o=>k.patch("/admin/account/switch",o),Ce=J({__name:"AddAccount",props:{modelValue:{},modelModifiers:{}},emits:ee(["getAccounts"],["update:modelValue"]),setup(o,{emit:s}){const w=s,b=te(o,"modelValue"),A=g(!1),d=g({cookie:""}),u=g(null),E={cookie:[{required:!0,message:"请输入Cookie",trigger:"blur"}]},x=async C=>{if(!(!C||!await C.validate()))try{A.value=!0,(await fe({cookie:d.value.cookie.split(`
`)})).data.have_repeat&&v.info("存在重复的cookie,已自动过滤"),v.success("添加成功")}finally{A.value=!1}},D=C=>{w("getAccounts"),C()},F=()=>{b.value=!1,w("getAccounts")};return(C,_)=>{const I=ae,z=le,U=ne,$=oe,V=K,S=se,n=Q;return r(),y(S,{title:"添加账号",width:"60%",modelValue:b.value,"onUpdate:modelValue":_[3]||(_[3]=a=>b.value=a),"before-close":D},{footer:t(()=>[l(V,{type:"info",onClick:_[1]||(_[1]=a=>F())},{default:t(()=>[c("取消")]),_:1}),l(V,{type:"primary",onClick:_[2]||(_[2]=a=>x(u.value))},{default:t(()=>[c("添加")]),_:1})]),default:t(()=>[H((r(),y($,{ref_key:"addAccountFormRef",ref:u,model:d.value,rules:E,"label-width":"auto"},{default:t(()=>[l(z,{label:"提示"},{default:t(()=>[l(I,null,{default:t(()=>[c("可以使用换行来分割多个账号")]),_:1})]),_:1}),l(z,{label:"Cookie",prop:"cookie"},{default:t(()=>[l(U,{type:"textarea",modelValue:d.value.cookie,"onUpdate:modelValue":_[0]||(_[0]=a=>d.value.cookie=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[n,A.value]])]),_:1},8,["modelValue"])}}}),we={key:0},$e=J({__name:"AccountManagement",setup(o){const s=g(!1),w=g(15),b=g(1),A=g(),d=g([]),u=async()=>{try{s.value=!0;const n=await ve({page:b.value,size:w.value});A.value=n.data}finally{s.value=!1}},E=async n=>{try{s.value=!0,await ge(n),v.success("更新账户信息成功")}finally{s.value=!1,await u()}},x=async()=>{try{s.value=!0;const n=d.value.map(a=>a.id);await ke(n),v.success("批量更新账户成功")}finally{s.value=!1,await u()}},D=async n=>{try{s.value=!0,await Ae(n),v.success("删除账户成功")}finally{s.value=!1,await u()}},F=async()=>{try{s.value=!0;const n=d.value.map(a=>a.id);await be(n),v.success("批量删除账户成功")}finally{s.value=!1,await u()}},C=async n=>{try{s.value=!0,await G({account:n,switch:1}),v.success("启用账户成功")}finally{s.value=!1,await u()}},_=async n=>{try{s.value=!0,await G({account:n,switch:0}),v.success("禁用账户成功")}finally{s.value=!1,await u()}},I=async()=>{try{s.value=!0;const n=d.value.map(a=>a.id);await O({account_ids:n,switch:1}),v.success("批量启用账户成功")}finally{s.value=!1,await u()}},z=async()=>{try{s.value=!0;const n=d.value.map(a=>a.id);await O({account_ids:n,switch:0}),v.success("批量禁用账户成功")}finally{s.value=!1,await u()}},U=n=>d.value=n;ce(u);const $=g(!1),V=()=>$.value=!$.value,S=async n=>{if(n.edit=!n.edit,n.edit===!1)try{s.value=!0,await ye(n),v.success("修改賬號成功")}finally{s.value=!1,await u()}};return(n,a)=>{var N,T,P;const p=K,i=ie,M=de,W=pe,X=re,Y=_e,Z=Q;return r(),B(j,null,[l(Ce,{onGetAccounts:u,modelValue:$.value,"onUpdate:modelValue":a[0]||(a[0]=e=>$.value=e)},null,8,["modelValue"]),l(p,{type:"primary",onClick:a[1]||(a[1]=e=>u())},{default:t(()=>[c("刷新列表")]),_:1}),l(p,{type:"primary",onClick:a[2]||(a[2]=e=>V())},{default:t(()=>[c("添加账号")]),_:1}),l(p,{type:"primary",disabled:d.value.length<=0,onClick:a[3]||(a[3]=e=>x())},{default:t(()=>[c(" 批量更新信息 ")]),_:1},8,["disabled"]),l(p,{type:"primary",disabled:d.value.length<=0,onClick:a[4]||(a[4]=e=>I())},{default:t(()=>[c(" 批量启用 ")]),_:1},8,["disabled"]),l(p,{type:"primary",disabled:d.value.length<=0,onClick:a[5]||(a[5]=e=>z())},{default:t(()=>[c(" 批量禁用 ")]),_:1},8,["disabled"]),l(p,{type:"danger",disabled:d.value.length<=0,onClick:a[6]||(a[6]=e=>F())},{default:t(()=>[c(" 批量删除 ")]),_:1},8,["disabled"]),H((r(),y(X,{data:((N=A.value)==null?void 0:N.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:U},{default:t(()=>[l(i,{type:"selection",width:"40"}),l(i,{prop:"id",label:"ID"}),l(i,{prop:"baidu_name",label:"百度用户名"}),l(i,{prop:"today_size",label:"今日解析"},{default:t(({row:e})=>[L("span",null,f(e.today_count)+" ("+f(R(q)(e.today_size??0))+")",1)]),_:1}),l(i,{prop:"today_size",label:"縂共解析"},{default:t(({row:e})=>[L("span",null,f(e.total_count)+" ("+f(R(q)(e.total_size??0))+")",1)]),_:1}),l(i,{prop:"cookie",label:"Cookie"}),l(i,{prop:"vip_type",label:"会员类型"}),l(i,{prop:"switch",label:"状态"},{default:t(({row:e})=>[L("span",null,f(e.switch?"启用":"禁用"),1)]),_:1}),l(i,{prop:"prov",label:"省份"},{default:t(({row:e})=>[e.edit?h("",!0):(r(),B("span",we,f(e.prov??"未使用"),1)),e.edit?(r(),y(W,{key:1,modelValue:e.prov,"onUpdate:modelValue":m=>e.prov=m},{default:t(()=>[(r(),y(M,{key:null,value:null},{default:t(()=>[c("未使用")]),_:1})),(r(),B(j,null,ue(["北京市","天津市","上海市","重庆市","河北省","山西省","内蒙古自治区","辽宁省","吉林省","黑龙江省","江苏省","浙江省","安徽省","福建省","江西省","山东省","河南省","湖北省","湖南省","广东省","广西壮族自治区","海南省","四川省","贵州省","云南省","西藏自治区","陕西省","甘肃省","青海省","宁夏回族自治区","新疆维吾尔自治区","香港特别行政区","澳门特别行政区","台湾省"],m=>l(M,{key:m,label:m,value:m},null,8,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])):h("",!0)]),_:1}),l(i,{prop:"reason",label:"禁用原因"},{default:t(({row:e})=>[c(f(e.reason??"未禁用"),1)]),_:1}),l(i,{prop:"svip_end_at",label:"超级会员结束时间"},{default:t(({row:e})=>[c(f(new Date(e.svip_end_at).toLocaleString()),1)]),_:1}),l(i,{prop:"last_use_at",label:"上次使用时间"},{default:t(({row:e})=>[c(f(new Date(e.last_use_at).toLocaleString()),1)]),_:1}),l(i,{prop:"created_at",label:"创建时间"},{default:t(({row:e})=>[c(f(new Date(e.created_at).toLocaleString()),1)]),_:1}),l(i,{prop:"updated_at",label:"更新时间"},{default:t(({row:e})=>[c(f(new Date(e.updated_at).toLocaleString()),1)]),_:1}),l(i,{width:"300",label:"操作",fixed:"right"},{default:t(({row:e})=>[l(p,{size:"small",type:"primary",onClick:m=>E(e)},{default:t(()=>[c("更新信息")]),_:2},1032,["onClick"]),e.switch===0?(r(),y(p,{key:0,size:"small",type:"primary",onClick:m=>C(e)},{default:t(()=>[c(" 启用 ")]),_:2},1032,["onClick"])):(r(),y(p,{key:1,size:"small",type:"primary",onClick:m=>_(e)},{default:t(()=>[c("禁用")]),_:2},1032,["onClick"])),e.edit?h("",!0):(r(),y(p,{key:2,size:"small",type:"primary",onClick:m=>S(e)},{default:t(()=>[c(" 編輯 ")]),_:2},1032,["onClick"])),e.edit?(r(),y(p,{key:3,size:"small",type:"primary",onClick:m=>S(e)},{default:t(()=>[c(" 完成 ")]),_:2},1032,["onClick"])):h("",!0),l(p,{size:"small",type:"danger",onClick:m=>D(e)},{default:t(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Z,s.value]]),l(Y,{"current-page":b.value,"onUpdate:currentPage":a[7]||(a[7]=e=>b.value=e),"page-size":w.value,"onUpdate:pageSize":a[8]||(a[8]=e=>w.value=e),"page-sizes":[15,50,100,500,((T=A.value)==null?void 0:T.total)??100],total:((P=A.value)==null?void 0:P.total)??100,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:u,onCurrentChange:u},null,8,["current-page","page-size","page-sizes","total"])],64)}}}),Ee=me($e,[["__scopeId","data-v-0ecc5cdc"]]);export{Ee as default};
