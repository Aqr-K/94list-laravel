import{b as R,$ as O,a0 as Q,r as _,f as k,c as C,n as l,l as t,x as c,w as q,E as m,G as W,z as X,y as Y,B as Z,A as G,K as ee,v as K,o as te,k as ae,t as f,e as U,q as I,F as le,N as oe,P as ne,a2 as se}from"./.pnpm-DVFgL_l4.js";import{i as y}from"./index-C61Nv7a3.js";import{f as N}from"./format-DaCfCw6f.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ue=s=>y.post("/admin/account",s),ie=s=>y.get(`/admin/account?page=${s.page}&size=${s.size}`),de=s=>y.patch("/admin/account",{account_ids:[s.id]}),re=s=>y.patch("/admin/account",{account_ids:s}),pe=s=>y.delete("/admin/account",{data:{account_ids:[s.id]}}),me=s=>y.delete("/admin/account",{data:{account_ids:s}}),P=s=>y.patch("/admin/account/switch",{account_ids:[s.account.id],switch:s.switch}),T=s=>y.patch("/admin/account/switch",s),_e=R({__name:"AddAccount",props:{modelValue:{},modelModifiers:{}},emits:O(["getAccounts"],["update:modelValue"]),setup(s,{emit:n}){const b=n,g=Q(s,"modelValue"),v=_(!1),r=_({cookie:""}),u=_(null),V={cookie:[{required:!0,message:"请输入Cookie",trigger:"blur"}]},S=async A=>{if(!(!A||!await A.validate()))try{v.value=!0,(await ue({cookie:r.value.cookie.split(`
`)})).data.have_repeat&&m.info("存在重复的cookie,已自动过滤"),m.success("添加成功")}finally{v.value=!1}},x=A=>{b("getAccounts"),A()},h=()=>{g.value=!1,b("getAccounts")};return(A,p)=>{const E=W,z=X,D=Y,w=Z,$=G,o=ee,a=K;return k(),C(o,{title:"添加账号",width:"60%",modelValue:g.value,"onUpdate:modelValue":p[3]||(p[3]=i=>g.value=i),"before-close":x},{footer:l(()=>[t($,{type:"info",onClick:p[1]||(p[1]=i=>h())},{default:l(()=>[c("取消")]),_:1}),t($,{type:"primary",onClick:p[2]||(p[2]=i=>S(u.value))},{default:l(()=>[c("添加")]),_:1})]),default:l(()=>[q((k(),C(w,{ref_key:"addAccountFormRef",ref:u,model:r.value,rules:V,"label-width":"auto"},{default:l(()=>[t(z,{label:"提示"},{default:l(()=>[t(E,null,{default:l(()=>[c("可以使用换行来分割多个账号")]),_:1})]),_:1}),t(z,{label:"Cookie",prop:"cookie"},{default:l(()=>[t(D,{type:"textarea",modelValue:r.value.cookie,"onUpdate:modelValue":p[0]||(p[0]=i=>r.value.cookie=i)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[a,v.value]])]),_:1},8,["modelValue"])}}}),ve=R({__name:"AccountManagement",setup(s){const n=_(!1),b=_(15),g=_(1),v=_(),r=_([]),u=async()=>{try{n.value=!0;const o=await ie({page:g.value,size:b.value});v.value=o.data}finally{n.value=!1}},V=async o=>{try{n.value=!0,await de(o),m.success("更新账户信息成功")}finally{n.value=!1,await u()}},S=async()=>{try{n.value=!0;const o=r.value.map(a=>a.id);await re(o),m.success("批量更新账户成功")}finally{n.value=!1,await u()}},x=async o=>{try{n.value=!0,await pe(o),m.success("删除账户成功")}finally{n.value=!1,await u()}},h=async()=>{try{n.value=!0;const o=r.value.map(a=>a.id);await me(o),m.success("批量删除账户成功")}finally{n.value=!1,await u()}},A=async o=>{try{n.value=!0,await P({account:o,switch:1}),m.success("启用账户成功")}finally{n.value=!1,await u()}},p=async o=>{try{n.value=!0,await P({account:o,switch:0}),m.success("禁用账户成功")}finally{n.value=!1,await u()}},E=async()=>{try{n.value=!0;const o=r.value.map(a=>a.id);await T({account_ids:o,switch:1}),m.success("批量启用账户成功")}finally{n.value=!1,await u()}},z=async()=>{try{n.value=!0;const o=r.value.map(a=>a.id);await T({account_ids:o,switch:0}),m.success("批量禁用账户成功")}finally{n.value=!1,await u()}},D=o=>r.value=o;te(u);const w=_(!1),$=()=>w.value=!w.value;return(o,a)=>{var B,M,L;const i=G,d=oe,j=ne,H=se,J=K;return k(),ae(le,null,[t(_e,{onGetAccounts:u,modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e)},null,8,["modelValue"]),t(i,{type:"primary",onClick:a[1]||(a[1]=e=>u())},{default:l(()=>[c("刷新列表")]),_:1}),t(i,{type:"primary",onClick:a[2]||(a[2]=e=>$())},{default:l(()=>[c("添加账号")]),_:1}),t(i,{type:"primary",disabled:r.value.length<=0,onClick:a[3]||(a[3]=e=>S())},{default:l(()=>[c(" 批量更新信息 ")]),_:1},8,["disabled"]),t(i,{type:"primary",disabled:r.value.length<=0,onClick:a[4]||(a[4]=e=>E())},{default:l(()=>[c(" 批量启用 ")]),_:1},8,["disabled"]),t(i,{type:"primary",disabled:r.value.length<=0,onClick:a[5]||(a[5]=e=>z())},{default:l(()=>[c(" 批量禁用 ")]),_:1},8,["disabled"]),t(i,{type:"danger",disabled:r.value.length<=0,onClick:a[6]||(a[6]=e=>h())},{default:l(()=>[c(" 批量删除 ")]),_:1},8,["disabled"]),q((k(),C(j,{data:((B=v.value)==null?void 0:B.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:D},{default:l(()=>[t(d,{type:"selection",width:"40"}),t(d,{prop:"id",label:"ID"}),t(d,{prop:"baidu_name",label:"百度用户名"}),t(d,{prop:"size",label:"今日解析量"},{default:l(({row:e})=>[c(f(U(N)(e.size)),1)]),_:1}),t(d,{prop:"size",label:"总解析量"},{default:l(({row:e})=>[c(f(U(N)(e.total_size)),1)]),_:1}),t(d,{prop:"cookie",label:"Cookie"}),t(d,{prop:"vip_type",label:"会员类型"}),t(d,{prop:"switch",label:"状态"},{default:l(({row:e})=>[I("span",null,f(e.switch?"启用":"禁用"),1)]),_:1}),t(d,{prop:"prov",label:"省份"},{default:l(({row:e})=>[I("span",null,f(e.prov??"未使用"),1)]),_:1}),t(d,{prop:"reason",label:"禁用原因"}),t(d,{prop:"svip_end_at",label:"超级会员结束时间"},{default:l(({row:e})=>[c(f(new Date(e.svip_end_at).toLocaleString()),1)]),_:1}),t(d,{prop:"last_use_at",label:"上次使用时间"},{default:l(({row:e})=>[c(f(new Date(e.last_use_at).toLocaleString()),1)]),_:1}),t(d,{prop:"created_at",label:"创建时间"},{default:l(({row:e})=>[c(f(new Date(e.created_at).toLocaleString()),1)]),_:1}),t(d,{prop:"updated_at",label:"更新时间"},{default:l(({row:e})=>[c(f(new Date(e.updated_at).toLocaleString()),1)]),_:1}),t(d,{width:"220",label:"操作",fixed:"right"},{default:l(({row:e})=>[t(i,{size:"small",type:"primary",onClick:F=>V(e)},{default:l(()=>[c("更新信息")]),_:2},1032,["onClick"]),e.switch===0?(k(),C(i,{key:0,size:"small",type:"primary",onClick:F=>A(e)},{default:l(()=>[c(" 启用 ")]),_:2},1032,["onClick"])):(k(),C(i,{key:1,size:"small",type:"primary",onClick:F=>p(e)},{default:l(()=>[c("禁用")]),_:2},1032,["onClick"])),t(i,{size:"small",type:"danger",onClick:F=>x(e)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[J,n.value]]),t(H,{"current-page":g.value,"onUpdate:currentPage":a[7]||(a[7]=e=>g.value=e),"page-size":b.value,"onUpdate:pageSize":a[8]||(a[8]=e=>b.value=e),"page-sizes":[15,50,100,500,((M=v.value)==null?void 0:M.total)??100],total:((L=v.value)==null?void 0:L.total)??100,layout:"sizes, prev, pager, next",onSizeChange:u,onCurrentChange:u},null,8,["current-page","page-size","page-sizes","total"])],64)}}}),be=ce(ve,[["__scopeId","data-v-29d3eb3c"]]);export{be as default};
