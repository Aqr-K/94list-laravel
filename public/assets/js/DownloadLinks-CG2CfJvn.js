import"./base-sonieuUH.js";import{E as j}from"./el-card-DSxRm4_o.js";import{E as P,a as U}from"./el-table-column-CCkEx7ov.js";import"./el-tag-D4crlrEn.js";import{E as z}from"./el-space-KyuUBOIf.js";import{E as I}from"./el-button-DDufFYF5.js";import{x as M,aj as H,d as g,B as J,N as K,o as u,c as E,e as h,f as t,a8 as Q,u as l,Q as R,n as _,H as $,W as w,J as W,a5 as q,ag as S,r as G,a,k as p,t as O,i as X,aa as Y,j as Z,E as m}from"./index-B8pW1vfL.js";import{u as x}from"./aria2Store-mwj0_eqr.js";import{u as ee}from"./fileListStore-DEWElJFp.js";import{c as D}from"./copy-BZ0g3H3d.js";import"./index-24Q8zd9x.js";import"./use-form-item-CJFbIM6h.js";import"./focus-trap-Cx3G5mYf.js";import"./vnode-CTXkDMm_.js";const ae=M({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:H}}),te={click:i=>i instanceof MouseEvent},oe=["href","target"],se=g({name:"ElLink"}),ne=g({...se,props:ae,emits:te,setup(i,{emit:r}){const n=i,o=J("link"),k=K(()=>[o.b(),o.m(n.type),o.is("disabled",n.disabled),o.is("underline",n.underline&&!n.disabled)]);function y(e){n.disabled||r("click",e)}return(e,b)=>(u(),E("a",{class:$(l(k)),href:e.disabled||!e.href?void 0:e.href,target:e.disabled||!e.href?void 0:e.target,onClick:y},[e.icon?(u(),h(l(R),{key:0},{default:t(()=>[(u(),h(Q(e.icon)))]),_:1})):_("v-if",!0),e.$slots.default?(u(),E("span",{key:1,class:$(l(o).e("inner"))},[w(e.$slots,"default")],2)):_("v-if",!0),e.$slots.icon?w(e.$slots,"icon",{key:2}):_("v-if",!0)],10,oe))}});var le=W(ne,[["__file","link.vue"]]);const ie=q(le),re=i=>new Promise(r=>setTimeout(r,i)),ce=X("h2",null,"链接列表",-1),$e=g({__name:"DownloadLinks",setup(i){const r=ee(),{downloadLinks:n}=S(r),o=G([]),k=s=>o.value=s,y=x(),{aria2ConfigForm:e,aria2ConfigDialogVisible:b}=S(y),C=async s=>{try{await Y.post(`${e.value.host}:${e.value.port}/jsonrpc`,{jsonrpc:"2.0",id:Z(),method:"aria2.addUri",params:[`token:${e.value.token}`,[s.url],{out:s.filename,header:[`User-Agent: ${s.ua}`]}]})}catch{return m.error("发送失败, 请检查控制台输出, 自行谷歌搜索或提交issue")}m.success(`已把${s.filename}任务发送给下载器`)},B=async()=>{m.error("请确保最大同时下载文件数在5及以下,否则可能出现下载失败!"),await re(3e3),m.success("开始下载"),o.value.forEach(s=>C(s))},A=()=>b.value=!0;return(s,L)=>{const f=I,N=z,c=P,F=ie,T=U,V=j;return l(n).length!==0?(u(),h(V,{key:0,class:"card"},{default:t(()=>[ce,a(N,null,{default:t(()=>[a(f,{type:"primary",disabled:o.value.length<=0,onClick:B},{default:t(()=>[p(" 批量下载 ")]),_:1},8,["disabled"]),a(f,{type:"primary",onClick:A},{default:t(()=>[p("下载配置")]),_:1})]),_:1}),a(T,{border:"","show-overflow-tooltip":"",class:"table",data:l(n),onSelectionChange:k},{default:t(()=>[a(c,{type:"selection",width:"40"}),a(c,{prop:"ua",label:"UA"},{default:t(({row:d})=>[a(F,{type:"danger",onClick:v=>l(D)(d.ua,"已复制UA")},{default:t(()=>[p(O(d.ua),1)]),_:2},1032,["onClick"])]),_:1}),a(c,{prop:"filename",label:"文件名"}),a(c,{prop:"url",label:"下载链接"}),a(c,{label:"操作",width:"190"},{default:t(({row:d})=>[a(f,{type:"primary",size:"small",onClick:v=>l(D)(d.url,"已将链接复制到粘贴板内")},{default:t(()=>[p(" 复制链接 ")]),_:2},1032,["onClick"]),a(f,{type:"primary",size:"small",onClick:v=>C(d)},{default:t(()=>[p(" 发送Aria2 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})):_("",!0)}}});export{$e as default};
