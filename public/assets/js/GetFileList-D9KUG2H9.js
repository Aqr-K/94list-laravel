import"./base-FFb6ABGl.js";import{v as J}from"./el-loading-SJb1wJ0I.js";import{E as Q}from"./el-card-DlDoXJKb.js";import{E as W,a as K}from"./el-form-item-kKOb3mX2.js";import{E as X}from"./el-button-C33TVszl.js";import{E as Y}from"./el-input-Bv-ge0Tw.js";import{u as x}from"./fileListStore-BdGMogu-.js";import{x as ee,ac as te,ad as Z,d as T,a0 as le,B as oe,r as P,N as A,o as n,e as c,f as r,w as G,i as M,H as v,u as e,Q as D,a8 as se,n as _,c as V,W as z,k as E,t as L,F as O,a,a4 as ae,ae as re,J as ie,af as ne,a5 as de,ag as N,m as ue,O as pe,E as R,j as ce}from"./index-q5nPSmrO.js";import{c as me}from"./copy-D4baswK9.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-form-item-DBXySpCx.js";import"./index-_lCbC3W8.js";const _e=["light","dark"],ve=ee({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:te(Z),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:_e,default:"light"}}),ye={close:C=>C instanceof MouseEvent},we=T({name:"ElAlert"}),ge=T({...we,props:ve,emits:ye,setup(C,{emit:y}){const k=C,{Close:l}=ne,b=le(),i=oe("alert"),m=P(!0),F=A(()=>Z[k.type]),w=A(()=>[i.e("icon"),{[i.is("big")]:!!k.description||!!b.default}]),B=A(()=>({"with-description":k.description||b.default})),$=s=>{m.value=!1,y("close",s)};return(s,I)=>(n(),c(re,{name:e(i).b("fade"),persisted:""},{default:r(()=>[G(M("div",{class:v([e(i).b(),e(i).m(s.type),e(i).is("center",s.center),e(i).is(s.effect)]),role:"alert"},[s.showIcon&&e(F)?(n(),c(e(D),{key:0,class:v(e(w))},{default:r(()=>[(n(),c(se(e(F))))]),_:1},8,["class"])):_("v-if",!0),M("div",{class:v(e(i).e("content"))},[s.title||s.$slots.title?(n(),V("span",{key:0,class:v([e(i).e("title"),e(B)])},[z(s.$slots,"title",{},()=>[E(L(s.title),1)])],2)):_("v-if",!0),s.$slots.default||s.description?(n(),V("p",{key:1,class:v(e(i).e("description"))},[z(s.$slots,"default",{},()=>[E(L(s.description),1)])],2)):_("v-if",!0),s.closable?(n(),V(O,{key:2},[s.closeText?(n(),V("div",{key:0,class:v([e(i).e("close-btn"),e(i).is("customed")]),onClick:$},L(s.closeText),3)):(n(),c(e(D),{key:1,class:v(e(i).e("close-btn")),onClick:$},{default:r(()=>[a(e(l))]),_:1},8,["class"]))],64)):_("v-if",!0)],2)],2),[[ae,m.value]])]),_:3},8,["name"]))}});var he=ie(ge,[["__file","alert.vue"]]);const ke=de(he),be=["src"],Ve=T({__name:"GetFileList",setup(C){const y=x(),{pending:k,getFileListForm:l,getFileListFormRef:b,selectedRows:i,vcode:m}=N(y),F=ue(),{config:w}=N(F),B=(t,o,u)=>o===""?u(new Error("请先输入需要解析的链接")):s(o)?u():u(new Error("请输入合法的链接")),$=()=>{const t=s(l.value.url);t&&(t.id&&(t.surl?l.value.url=`https://pan.baidu.com/share/init?surl=${t.id}`:l.value.url=`https://pan.baidu.com/s/${t.id}`,l.value.shorturl=t.id),t.pwd&&(l.value.pwd=t.pwd,R.success("已自动填写密码")))},s=t=>{const o=t.match(/s\/([a-zA-Z0-9_-]+)/),u=t.match(/surl=([a-zA-Z0-9_-]+)/),f=t.match(/\?pwd=([a-zA-Z0-9_-]+)/),p=t.match(/&pwd=([a-zA-Z0-9_-]+)/),g=t.match(/提取码:\s?([a-zA-Z0-9_-]+)/);let h;if(u)h=u[1];else if(o)h=o[1];else return!1;const S=f?f[1]:p?p[1]:g?g[1]:null;return u?{surl:!0,id:h,pwd:S}:{id:h,pwd:S}},I={url:[{required:!0,validator:B,trigger:"blur"}]},j=async t=>{!t||!await t.validate()||me(`${location.host}/?url=${l.value.url}&shorturl=${l.value.shorturl}&pwd=${l.value.pwd}&dir=${l.value.dir}`,"复制成功")};pe(()=>{const t=new URLSearchParams(location.search);t.size<4||(l.value.url=t.get("url")??"",l.value.pwd=t.get("pwd")??"",l.value.dir=t.get("dir")??"/",l.value.shorturl=t.get("shorturl")??"",R.success("已读取到参数,正在加载"),setTimeout(()=>y.getFileList,1e3))});const U=P(Date.now()),q=()=>U.value=Date.now();return(t,o)=>{const u=ke,f=Y,p=W,g=X,h=K,S=Q,H=J;return G((n(),c(S,null,{default:r(()=>[M("h2",null,"前台解析中心 | "+L(e(ce)()),1),e(w).have_account?(n(),c(u,{key:0,title:"当前中转账号充足",type:"success"})):(n(),c(u,{key:1,title:"当前中转账号不足",type:"error"})),e(w).debug?(n(),c(u,{key:2,class:"alert",title:"当前网站开启了DEBUG模式,非调试请关闭!!!!",type:"error"})):_("",!0),e(w).is_https?_("",!0):(n(),c(u,{key:3,class:"alert",title:"当前网站未开启SSL,可能出现无法请求Aria2服务器的问题",type:"error"})),a(h,{ref_key:"getFileListFormRef",ref:b,model:e(l),rules:I,"label-width":"auto",class:"form"},{default:r(()=>[a(p,{label:"链接",prop:"url"},{default:r(()=>[a(f,{modelValue:e(l).url,"onUpdate:modelValue":o[0]||(o[0]=d=>e(l).url=d),modelModifiers:{trim:!0},onBlur:o[1]||(o[1]=d=>$())},null,8,["modelValue"])]),_:1}),a(p,{label:"密码",prop:"pwd"},{default:r(()=>[a(f,{modelValue:e(l).pwd,"onUpdate:modelValue":o[2]||(o[2]=d=>e(l).pwd=d),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),e(w).need_password?(n(),c(p,{key:0,label:"解析密码",prop:"password"},{default:r(()=>[a(f,{modelValue:e(l).password,"onUpdate:modelValue":o[3]||(o[3]=d=>e(l).password=d),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})):_("",!0),a(p,{label:"当前路径",prop:"dir"},{default:r(()=>[a(f,{modelValue:e(l).dir,"onUpdate:modelValue":o[4]||(o[4]=d=>e(l).dir=d),disabled:""},null,8,["modelValue"])]),_:1}),e(m).hit_captcha?(n(),V(O,{key:1},[a(p,{label:"验证码图片",prop:"vcode_img"},{default:r(()=>[M("img",{src:`${e(m).vcode_img}&time=${U.value}`,alt:"验证码图片",onClick:q},null,8,be)]),_:1}),a(p,{label:"验证码ID",prop:"vcode_id"},{default:r(()=>[a(f,{modelValue:e(m).vcode_id,"onUpdate:modelValue":o[5]||(o[5]=d=>e(m).vcode_id=d),modelModifiers:{trim:!0},disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"验证码",prop:"vcode_input"},{default:r(()=>[a(f,{modelValue:e(m).vcode_input,"onUpdate:modelValue":o[6]||(o[6]=d=>e(m).vcode_input=d),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})],64)):_("",!0),a(p,{label:" "},{default:r(()=>[a(g,{type:"primary",onClick:e(y).getFileList},{default:r(()=>[E("获取文件列表")]),_:1},8,["onClick"]),a(g,{type:"primary",disabled:e(i).length<=0,onClick:e(y).downloadFiles},{default:r(()=>[E(" 批量解析 ")]),_:1},8,["disabled","onClick"]),a(g,{type:"primary",onClick:o[7]||(o[7]=d=>j(e(b)))},{default:r(()=>[E("复制当前地址")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})),[[H,e(k)]])}}}),De=fe(Ve,[["__scopeId","data-v-15159f80"]]);export{De as default};
