import"./base-DzfnSdGl.js";import{v as S}from"./el-loading-Dqc-yn7H.js";import{E as P,a as U}from"./el-form-item-Ct3QjCMy.js";import{E as q}from"./el-button-DtYNY52B.js";import{E as k}from"./el-input-BEQYXOrs.js";import"./el-tag-CUh0AjBU.js";import{E as F,a as x}from"./el-select-CZZ_1tAL.js";import{E as B}from"./el-switch-DWISdYF0.js";import{aa as i,d as R,r as d,O as $,w as I,o as v,e as L,f as t,a,c as N,F as O,aE as z,k as V,E as c}from"./index-niWMSR8p.js";import"./use-form-item-DsYTp4Yb.js";import"./index-Bbp7VP7R.js";import"./focus-trap-CVuM4905.js";import"./AdminView-Cgf6NGdE.js";import"./el-card-D0AZMfBh.js";import"./user-Cd5hS_vJ.js";import"./vnode-CSQD_1u2.js";import"./scroll-DGkImYz_.js";const D=()=>i.get("/admin/config/mail"),j=p=>i.patch("/admin/config/mail",p),A=()=>i.post("/admin/config/mail"),ne=R({__name:"ChangeMailConfig",setup(p){const s=d(!1),o=d({switch:!1,host:"",port:"",username:"",password:"",encryption:"tls",from_address:"",from_name:"",to_address:"",to_name:""}),m=d(null),b={host:[{required:!0,message:"请输入SMTP服务器地址",trigger:"blur"}],port:[{required:!0,message:"请输入SMTP服务器端口",trigger:"blur"}],username:[{required:!0,message:"请输入SMTP服务器账户",trigger:"blur"}],password:[{required:!0,message:"请输入SMTP服务器密码",trigger:"blur"}],encryption:[{required:!0,message:"请选择SMTP服务器加密方式",trigger:"blur"}],from_address:[{required:!0,message:"请输入发件人地址",trigger:"blur"}],from_name:[{required:!0,message:"请输入发件人名称",trigger:"blur"}],to_address:[{required:!0,message:"请输入收件人地址",trigger:"blur"}],to_name:[{required:!0,message:"请输入收件人名称",trigger:"blur"}]},f=async()=>{try{s.value=!0;const u=await D();o.value=u.data}finally{s.value=!1}},g=async u=>{if(!(!u||!await u.validate()))try{s.value=!0,await j(o.value),c.success("保存成功")}finally{s.value=!1,await f()}},w=async u=>{if(!(!u||!await u.validate()))try{s.value=!0,await g(u),await A(),c.success("发送成功,请检查邮箱是否收到")}finally{s.value=!1}};return $(f),(u,l)=>{const y=B,r=P,n=k,M=F,C=x,_=q,E=U,T=S;return I((v(),L(E,{ref_key:"changeMailConfigFormRef",ref:m,model:o.value,rules:b,"label-width":"auto"},{default:t(()=>[a(r,{label:"是否开启",prop:"switch"},{default:t(()=>[a(y,{modelValue:o.value.switch,"onUpdate:modelValue":l[0]||(l[0]=e=>o.value.switch=e),size:"large"},null,8,["modelValue"])]),_:1}),a(r,{label:"SMTP服务器地址",prop:"host"},{default:t(()=>[a(n,{modelValue:o.value.host,"onUpdate:modelValue":l[1]||(l[1]=e=>o.value.host=e)},null,8,["modelValue"])]),_:1}),a(r,{label:"SMTP服务器加密方式",prop:"encryption"},{default:t(()=>[a(C,{modelValue:o.value.encryption,"onUpdate:modelValue":l[2]||(l[2]=e=>o.value.encryption=e),placeholder:"选择加密方式"},{default:t(()=>[(v(),N(O,null,z(["tls","ssl"],e=>a(M,{key:e,label:e,value:e},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"SMTP服务器端口",prop:"port"},{default:t(()=>[a(n,{modelValue:o.value.port,"onUpdate:modelValue":l[3]||(l[3]=e=>o.value.port=e)},null,8,["modelValue"])]),_:1}),a(r,{label:"SMTP服务器用户名",prop:"username"},{default:t(()=>[a(n,{modelValue:o.value.username,"onUpdate:modelValue":l[4]||(l[4]=e=>o.value.username=e)},null,8,["modelValue"])]),_:1}),a(r,{label:"SMTP服务器密码",prop:"password"},{default:t(()=>[a(n,{modelValue:o.value.password,"onUpdate:modelValue":l[5]||(l[5]=e=>o.value.password=e)},null,8,["modelValue"])]),_:1}),a(r,{label:"发件人地址",prop:"from_address"},{default:t(()=>[a(n,{modelValue:o.value.from_address,"onUpdate:modelValue":l[6]||(l[6]=e=>o.value.from_address=e)},null,8,["modelValue"])]),_:1}),a(r,{label:"发件人名称",prop:"from_name"},{default:t(()=>[a(n,{modelValue:o.value.from_name,"onUpdate:modelValue":l[7]||(l[7]=e=>o.value.from_name=e)},null,8,["modelValue"])]),_:1}),a(r,{label:"收件人名称",prop:"to_name"},{default:t(()=>[a(n,{modelValue:o.value.to_name,"onUpdate:modelValue":l[8]||(l[8]=e=>o.value.to_name=e)},null,8,["modelValue"])]),_:1}),a(r,{label:"收件人地址",prop:"to_address"},{default:t(()=>[a(n,{modelValue:o.value.to_address,"onUpdate:modelValue":l[9]||(l[9]=e=>o.value.to_address=e)},null,8,["modelValue"])]),_:1}),a(r,{label:" "},{default:t(()=>[a(_,{type:"primary",onClick:l[10]||(l[10]=e=>g(m.value))},{default:t(()=>[V("保存")]),_:1}),a(_,{type:"primary",onClick:l[11]||(l[11]=e=>w(m.value))},{default:t(()=>[V(" 发送测试邮件 ")]),_:1})]),_:1})]),_:1},8,["model"])),[[T,s.value]])}}});export{ne as default};
