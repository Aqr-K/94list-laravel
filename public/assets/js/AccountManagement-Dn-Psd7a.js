import"./base-DzfnSdGl.js";import{v as T}from"./el-loading-Dqc-yn7H.js";import{E as K}from"./el-pagination-DwvF7Wex.js";import{E as O}from"./el-input-BEQYXOrs.js";import"./el-tag-CUh0AjBU.js";import"./el-select-CZZ_1tAL.js";import{E as j,a as H}from"./el-table-column-BcnOE-AB.js";import{E as N}from"./el-button-DtYNY52B.js";import{aa as v,d as P,aK as J,aL as Q,r as f,o as b,e as C,f as o,a as e,k as c,w as M,E as m,O as W,c as X,i as Y,t as k,a4 as Z,F as ee}from"./index-niWMSR8p.js";import{E as te}from"./el-overlay-3YP-gJF7.js";import{E as ae,a as oe}from"./el-form-item-Ct3QjCMy.js";import{E as le}from"./AdminView-Cgf6NGdE.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-Bbp7VP7R.js";import"./use-form-item-DsYTp4Yb.js";import"./focus-trap-CVuM4905.js";import"./scroll-DGkImYz_.js";import"./vnode-CSQD_1u2.js";import"./el-card-D0AZMfBh.js";import"./user-Cd5hS_vJ.js";const se=s=>v.post("/admin/account",s),ce=s=>v.get(`/admin/account?page=${s.page}&size=${s.size}`),ie=s=>v.patch(`/admin/account/${s.id}`),ue=s=>v.patch("/admin/account",{account_ids:s}),de=s=>v.delete("/admin/account",{data:{account_ids:[s.id]}}),re=s=>v.delete("/admin/account",{data:{account_ids:s}}),U=s=>v.patch("/admin/account/switch",{account_ids:[s.account.id],switch:s.switch}),I=s=>v.patch("/admin/account/switch",s),pe=P({__name:"AddAccount",props:{modelValue:{},modelModifiers:{}},emits:J(["getAccounts"],["update:modelValue"]),setup(s,{emit:n}){const A=n,_=Q(s,"modelValue"),y=f(!1),d=f({cookie:""}),i=f(null),V={cookie:[{required:!0,message:"请输入Cookie",trigger:"blur"}]},z=async g=>{if(!(!g||!await g.validate()))try{y.value=!0,await se({cookie:d.value.cookie.split(`
`)}),m.success("添加成功")}finally{y.value=!1}},S=g=>{A("getAccounts"),g()},h=()=>{_.value=!1,A("getAccounts")};return(g,p)=>{const x=le,$=ae,D=O,w=oe,E=N,l=te,t=T;return b(),C(l,{title:"添加账号",width:"60%",modelValue:_.value,"onUpdate:modelValue":p[3]||(p[3]=u=>_.value=u),"before-close":S},{footer:o(()=>[e(E,{type:"info",onClick:p[1]||(p[1]=u=>h())},{default:o(()=>[c("取消")]),_:1}),e(E,{type:"primary",onClick:p[2]||(p[2]=u=>z(i.value))},{default:o(()=>[c("添加")]),_:1})]),default:o(()=>[M((b(),C(w,{ref_key:"addAccountFormRef",ref:i,model:d.value,rules:V,"label-width":"auto"},{default:o(()=>[e($,{label:"提示"},{default:o(()=>[e(x,null,{default:o(()=>[c("可以使用换行来分割多个账号")]),_:1})]),_:1}),e($,{label:"Cookie",prop:"cookie"},{default:o(()=>[e(D,{type:"textarea",modelValue:d.value.cookie,"onUpdate:modelValue":p[0]||(p[0]=u=>d.value.cookie=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[t,y.value]])]),_:1},8,["modelValue"])}}}),me=P({__name:"AccountManagement",setup(s){const n=f(!1),A=f(15),_=f(1),y=f(),d=f([]),i=async()=>{try{n.value=!0;const l=await ce({page:_.value,size:A.value});y.value=l.data}finally{n.value=!1}},V=async l=>{try{n.value=!0,await ie(l),m.success("更新账户信息成功")}finally{n.value=!1,await i()}},z=async()=>{try{n.value=!0;const l=d.value.map(t=>t.id);await ue(l),m.success("批量更新账户成功")}finally{n.value=!1,await i()}},S=async l=>{try{n.value=!0,await de(l),m.success("删除账户成功")}finally{n.value=!1,await i()}},h=async()=>{try{n.value=!0;const l=d.value.map(t=>t.id);await re(l),m.success("批量删除账户成功")}finally{n.value=!1,await i()}},g=async l=>{try{n.value=!0,await U({account:l,switch:1}),m.success("启用账户成功")}finally{n.value=!1,await i()}},p=async l=>{try{n.value=!0,await U({account:l,switch:0}),m.success("禁用账户成功")}finally{n.value=!1,await i()}},x=async()=>{try{n.value=!0;const l=d.value.map(t=>t.id);await I({account_ids:l,switch:1}),m.success("批量启用账户成功")}finally{n.value=!1,await i()}},$=async()=>{try{n.value=!0;const l=d.value.map(t=>t.id);await I({account_ids:l,switch:0}),m.success("批量禁用账户成功")}finally{n.value=!1,await i()}},D=l=>d.value=l;W(i);const w=f(!1),E=()=>w.value=!w.value;return(l,t)=>{var L,B;const u=N,r=j,R=H,q=K,G=T;return b(),X(ee,null,[e(pe,{onGetAccounts:i,modelValue:w.value,"onUpdate:modelValue":t[0]||(t[0]=a=>w.value=a)},null,8,["modelValue"]),e(u,{type:"primary",onClick:t[1]||(t[1]=a=>i())},{default:o(()=>[c("刷新列表")]),_:1}),e(u,{type:"primary",onClick:t[2]||(t[2]=a=>E())},{default:o(()=>[c("添加账号")]),_:1}),e(u,{type:"primary",disabled:d.value.length<=0,onClick:t[3]||(t[3]=a=>z())},{default:o(()=>[c(" 批量更新信息 ")]),_:1},8,["disabled"]),e(u,{type:"primary",disabled:d.value.length<=0,onClick:t[4]||(t[4]=a=>x())},{default:o(()=>[c(" 批量启用 ")]),_:1},8,["disabled"]),e(u,{type:"primary",disabled:d.value.length<=0,onClick:t[5]||(t[5]=a=>$())},{default:o(()=>[c(" 批量禁用 ")]),_:1},8,["disabled"]),e(u,{type:"danger",disabled:d.value.length<=0,onClick:t[6]||(t[6]=a=>h())},{default:o(()=>[c(" 批量删除 ")]),_:1},8,["disabled"]),M((b(),C(R,{data:((L=y.value)==null?void 0:L.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:D},{default:o(()=>[e(r,{type:"selection",width:"40"}),e(r,{prop:"id",label:"ID"}),e(r,{prop:"baidu_name",label:"百度用户名"}),e(r,{prop:"netdisk_name",label:"网盘用户名"}),e(r,{prop:"cookie",label:"Cookie"}),e(r,{prop:"vip_type",label:"会员类型"}),e(r,{prop:"switch",label:"状态"},{default:o(({row:a})=>[M(Y("span",null,k(a.switch?"启用":"禁用"),513),[[Z,!a.edit]])]),_:1}),e(r,{prop:"reason",label:"禁用原因"}),e(r,{prop:"svip_end_at",label:"超级会员结束时间"},{default:o(({row:a})=>[c(k(new Date(a.svip_end_at).toLocaleString()),1)]),_:1}),e(r,{prop:"last_use_at",label:"上次使用时间"},{default:o(({row:a})=>[c(k(new Date(a.last_use_at).toLocaleString()),1)]),_:1}),e(r,{prop:"created_at",label:"创建时间"},{default:o(({row:a})=>[c(k(new Date(a.created_at).toLocaleString()),1)]),_:1}),e(r,{prop:"updated_at",label:"更新时间"},{default:o(({row:a})=>[c(k(new Date(a.updated_at).toLocaleString()),1)]),_:1}),e(r,{width:"220",label:"操作",fixed:"right"},{default:o(({row:a})=>[e(u,{size:"small",type:"primary",onClick:F=>V(a)},{default:o(()=>[c("更新信息")]),_:2},1032,["onClick"]),a.switch===0?(b(),C(u,{key:0,size:"small",type:"primary",onClick:F=>g(a)},{default:o(()=>[c(" 启用 ")]),_:2},1032,["onClick"])):(b(),C(u,{key:1,size:"small",type:"primary",onClick:F=>p(a)},{default:o(()=>[c("禁用")]),_:2},1032,["onClick"])),e(u,{size:"small",type:"danger",onClick:F=>S(a)},{default:o(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[G,n.value]]),e(q,{"current-page":_.value,"onUpdate:currentPage":t[7]||(t[7]=a=>_.value=a),"page-size":A.value,"onUpdate:pageSize":t[8]||(t[8]=a=>A.value=a),"page-sizes":[15,30,50,100],total:((B=y.value)==null?void 0:B.total)??100,layout:"sizes, prev, pager, next",onSizeChange:i,onCurrentChange:i},null,8,["current-page","page-size","total"])],64)}}}),Le=ne(me,[["__scopeId","data-v-786f4fe5"]]);export{Le as default};
