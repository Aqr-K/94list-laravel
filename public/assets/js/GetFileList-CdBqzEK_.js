import"./base-ByW8jBp4.js";import{v as j}from"./el-loading-DZ7aAvs5.js";import{E as q}from"./el-card-COj0nMSe.js";import{E as H,a as J}from"./el-form-item-Dlr1zLGR.js";import{E as Q}from"./el-button-Dx7S_srm.js";import{E as W}from"./el-input-Cfcxms0_.js";import{u as K}from"./fileListStore-DkGhdaan.js";import{x as X,ac as Y,ad as D,d as I,a0 as x,B as ee,r as te,N as B,o as i,e as p,f as n,w as Z,i as A,H as y,u as e,Q as R,a8 as se,n as w,c as V,W as U,k,t as L,F as oe,a as r,a4 as le,ae,J as re,af as ne,a5 as ie,ag as z,m as ue,O as de,E as N,h as pe,j as ce}from"./index-CUfiTvNe.js";import{c as me}from"./copy-ByZDDYAU.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-form-item-JWbWLwGP.js";import"./index-CdeJMTo1.js";const ve=["light","dark"],ye=X({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:Y(D),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:ve,default:"light"}}),we={close:C=>C instanceof MouseEvent},_e=I({name:"ElAlert"}),ge=I({..._e,props:ye,emits:we,setup(C,{emit:_}){const h=C,{Close:s}=ne,b=x(),a=ee("alert"),F=te(!0),m=B(()=>D[h.type]),S=B(()=>[a.e("icon"),{[a.is("big")]:!!h.description||!!b.default}]),M=B(()=>({"with-description":h.description||b.default})),E=l=>{F.value=!1,_("close",l)};return(l,T)=>(i(),p(ae,{name:e(a).b("fade"),persisted:""},{default:n(()=>[Z(A("div",{class:y([e(a).b(),e(a).m(l.type),e(a).is("center",l.center),e(a).is(l.effect)]),role:"alert"},[l.showIcon&&e(m)?(i(),p(e(R),{key:0,class:y(e(S))},{default:n(()=>[(i(),p(se(e(m))))]),_:1},8,["class"])):w("v-if",!0),A("div",{class:y(e(a).e("content"))},[l.title||l.$slots.title?(i(),V("span",{key:0,class:y([e(a).e("title"),e(M)])},[U(l.$slots,"title",{},()=>[k(L(l.title),1)])],2)):w("v-if",!0),l.$slots.default||l.description?(i(),V("p",{key:1,class:y(e(a).e("description"))},[U(l.$slots,"default",{},()=>[k(L(l.description),1)])],2)):w("v-if",!0),l.closable?(i(),V(oe,{key:2},[l.closeText?(i(),V("div",{key:0,class:y([e(a).e("close-btn"),e(a).is("customed")]),onClick:E},L(l.closeText),3)):(i(),p(e(R),{key:1,class:y(e(a).e("close-btn")),onClick:E},{default:n(()=>[r(e(s))]),_:1},8,["class"]))],64)):w("v-if",!0)],2)],2),[[le,F.value]])]),_:3},8,["name"]))}});var ke=re(ge,[["__file","alert.vue"]]);const he=ie(ke),be=I({__name:"GetFileList",setup(C){const _=K(),{pending:h,getFileListForm:s,getFileListFormRef:b,selectedRows:a}=z(_),F=ue(),{config:m}=z(F),S=(t,o,u)=>o===""?u(new Error("请先输入需要解析的链接")):E(o)?u():u(new Error("请输入合法的链接")),M=()=>{const t=E(s.value.url);t&&(t.id&&(t.surl?s.value.url=`https://pan.baidu.com/share/init?surl=${t.id}`:s.value.url=`https://pan.baidu.com/s/${t.id}`,s.value.shorturl=t.id),t.pwd&&(s.value.pwd=t.pwd,N.success("已自动填写密码")))},E=t=>{const o=t.match(/s\/([a-zA-Z0-9_-]+)/),u=t.match(/surl=([a-zA-Z0-9_-]+)/),f=t.match(/\?pwd=([a-zA-Z0-9_-]+)/),c=t.match(/&pwd=([a-zA-Z0-9_-]+)/),v=t.match(/提取码:\s?([a-zA-Z0-9_-]+)/);let g;if(u)g=u[1];else if(o)g=o[1];else return!1;const $=f?f[1]:c?c[1]:v?v[1]:null;return u?{surl:!0,id:g,pwd:$}:{id:g,pwd:$}},l={url:[{required:!0,validator:S,trigger:"blur"}]},T=async t=>{!t||!await t.validate()||me(`${location.host}/?url=${s.value.url}&shorturl=${s.value.shorturl}&pwd=${s.value.pwd}&dir=${encodeURIComponent(s.value.dir)}`,"复制成功")};de(()=>{const t=new URLSearchParams(location.search);t.size<4||(s.value.url=t.get("url")??"",s.value.pwd=t.get("pwd")??"",s.value.dir=t.get("dir")??"/",s.value.shorturl=t.get("shorturl")??"",N.success("已读取到参数,正在加载"),setTimeout(()=>_.getFileList(),1e3))});const P=pe(),G=()=>P.push("/login");return(t,o)=>{const u=he,f=W,c=H,v=Q,g=J,$=q,O=j;return Z((i(),p($,null,{default:n(()=>[A("h2",null,"前台解析中心 | "+L(e(ce)()),1),e(m).have_account?(i(),p(u,{key:0,title:"当前中转账号充足",type:"success"})):(i(),p(u,{key:1,title:"当前中转账号不足",type:"error"})),e(m).debug?(i(),p(u,{key:2,class:"alert",title:"当前网站开启了DEBUG模式,非调试请关闭!!!!",type:"error"})):w("",!0),e(m).is_https?w("",!0):(i(),p(u,{key:3,class:"alert",title:"当前网站未开启SSL,可能出现无法请求Aria2服务器的问题",type:"error"})),r(g,{ref_key:"getFileListFormRef",ref:b,model:e(s),rules:l,"label-width":"auto",class:"form"},{default:n(()=>[r(c,{label:"链接",prop:"url"},{default:n(()=>[r(f,{modelValue:e(s).url,"onUpdate:modelValue":o[0]||(o[0]=d=>e(s).url=d),modelModifiers:{trim:!0},onBlur:o[1]||(o[1]=d=>M())},null,8,["modelValue"])]),_:1}),r(c,{label:"密码",prop:"pwd"},{default:n(()=>[r(f,{modelValue:e(s).pwd,"onUpdate:modelValue":o[2]||(o[2]=d=>e(s).pwd=d),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),e(m).need_password?(i(),p(c,{key:0,label:"解析密码",prop:"password"},{default:n(()=>[r(f,{modelValue:e(s).password,"onUpdate:modelValue":o[3]||(o[3]=d=>e(s).password=d),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})):w("",!0),r(c,{label:"当前路径",prop:"dir"},{default:n(()=>[r(f,{modelValue:e(s).dir,"onUpdate:modelValue":o[4]||(o[4]=d=>e(s).dir=d),disabled:""},null,8,["modelValue"])]),_:1}),r(c,{label:" "},{default:n(()=>[r(v,{type:"primary",onClick:o[5]||(o[5]=d=>e(_).getFileList())},{default:n(()=>[k("获取文件列表")]),_:1}),r(v,{type:"primary",disabled:e(a).length<=0,onClick:o[6]||(o[6]=d=>e(_).downloadFiles())},{default:n(()=>[k(" 批量解析 ")]),_:1},8,["disabled"]),r(v,{type:"primary",onClick:o[7]||(o[7]=d=>T(e(b)))},{default:n(()=>[k("复制当前地址")]),_:1}),r(v,{type:"primary",onClick:o[8]||(o[8]=d=>G())},{default:n(()=>[k("登陆")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})),[[O,e(h)]])}}}),Re=fe(be,[["__scopeId","data-v-1774b6e9"]]);export{Re as default};
