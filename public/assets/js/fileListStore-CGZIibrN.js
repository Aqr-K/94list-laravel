import{an as p,r as a,ao as w,E as d,ap as F}from"./index-niWMSR8p.js";const L=p("fileListStore",()=>{const t=a(!1),l=a({shorturl:"",url:"",pwd:"",dir:"/"}),o=a(null),c=()=>{const e=l.value.dir.split("/");e.pop();const i=e.join("/");return i===""?"/":i},v=async()=>{if(!(!o.value||!await o.value.validate()))try{n.value=[],t.value=!0;const e=await w(l.value);s.value=e.data,l.value.dir!=="/"&&s.value.list.unshift({category:-1,fs_id:0,isdir:1,local_ctime:0,local_mtime:0,server_ctime:0,server_mtime:0,size:0,md5:"",path:c(),server_filename:"..",dlink:""}),d.success("获取文件列表成功")}finally{t.value=!1}},s=a({uk:0,shareid:0,randsk:"",list:[]}),n=a([]),u=a([]);return{pending:t,fileList:s,getFileList:v,getFileListForm:l,getFileListFormRef:o,selectedRows:n,downloadFiles:async(e,i)=>{const f=e?[e]:n.value.map(r=>r.fs_id),m=i?[i]:n.value.map(r=>r.path);try{t.value=!0;const r=await F({uk:s.value.uk,shareid:s.value.shareid,randsk:s.value.randsk,fs_ids:f,path_list:m,url:l.value.url});u.value=r.data,d.success("解析成功")}finally{t.value=!1}},downloadLinks:u}});export{L as u};
