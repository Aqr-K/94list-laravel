import{C as te,I as q,U as A,t as me,d as Q}from"./base-9ed7a3b4.js";import{v as ce}from"./el-loading-ea36553a.js";import{E as pe,a as fe}from"./el-form-item-a5242619.js";import{E as ge}from"./el-button-3b2ee6a5.js";import{E as re}from"./el-input-feb7aa1f.js";import{E as be}from"./el-switch-67570869.js";import{a7 as X,a as j,r as H,N as ve,g as x,G as Ve,o as le,J as we,e as I,c as $,P as J,u as n,n as Y,af as D,b as u,w as f,R as F,i as Z,a6 as O,L as Ne,d as _e,m as he,q as ye,B as Ee}from"./index-fee14184.js";import{b as Ie,c as Se,e as Ce}from"./admin-b20f8c58.js";import{b as Pe,y as ke,n as _,C as xe,u as Ae,l as R,D as Fe,F as Ue,f as ee,G as Te,p as Me,_ as Be,w as ze,E as W}from"./request-56692d6c.js";import{i as U}from"./isNil-c75b1b34.js";import{a as De,u as Oe,b as Re}from"./use-form-item-70fcde04.js";import"./_initCloneObject-6cd35402.js";import"./index-61ed4cec.js";import"./validator-3f44b6fb.js";const qe=100,Le=600,ne={beforeMount(i,h){const t=h.value,{interval:a=qe,delay:C=Le}=X(t)?{}:t;let b,V;const d=()=>X(t)?t():t.handler(),N=()=>{V&&(clearTimeout(V),V=void 0),b&&(clearInterval(b),b=void 0)};i.addEventListener("mousedown",v=>{v.button===0&&(N(),d(),document.addEventListener("mouseup",()=>N(),{once:!0}),V=setTimeout(()=>{b=setInterval(()=>{d()},a)},C))})}},Ge=Pe({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:ke,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:i=>i===null||_(i)||["min","max"].includes(i),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:i=>i>=0&&i===Number.parseInt(`${i}`,10)},validateEvent:{type:Boolean,default:!0}}),Ke={[te]:(i,h)=>h!==i,blur:i=>i instanceof FocusEvent,focus:i=>i instanceof FocusEvent,[q]:i=>_(i)||U(i),[A]:i=>_(i)||U(i)},$e=["aria-label","onKeydown"],Ye=["aria-label","onKeydown"],We=j({name:"ElInputNumber"}),He=j({...We,props:Ge,emits:Ke,setup(i,{expose:h,emit:t}){const a=i,{t:C}=xe(),b=Ae("input-number"),V=H(),d=ve({currentValue:a.modelValue,userInput:null}),{formItem:N}=De(),v=x(()=>_(a.modelValue)&&a.modelValue<=a.min),l=x(()=>_(a.modelValue)&&a.modelValue>=a.max),g=x(()=>{const e=T(a.step);return R(a.precision)?Math.max(T(a.modelValue),e):(e>a.precision,a.precision)}),m=x(()=>a.controls&&a.controlsPosition==="right"),S=Oe(),E=Re(),P=x(()=>{if(d.userInput!==null)return d.userInput;let e=d.currentValue;if(U(e))return"";if(_(e)){if(Number.isNaN(e))return"";R(a.precision)||(e=e.toFixed(a.precision))}return e}),k=(e,r)=>{if(R(r)&&(r=g.value),r===0)return Math.round(e);let o=String(e);const c=o.indexOf(".");if(c===-1||!o.replace(".","").split("")[c+r])return e;const B=o.length;return o.charAt(B-1)==="5"&&(o=`${o.slice(0,Math.max(0,B-1))}6`),Number.parseFloat(Number(o).toFixed(r))},T=e=>{if(U(e))return 0;const r=e.toString(),o=r.indexOf(".");let c=0;return o!==-1&&(c=r.length-o-1),c},s=(e,r=1)=>_(e)?k(e+a.step*r):d.currentValue,L=()=>{if(a.readonly||E.value||l.value)return;const e=Number(P.value)||0,r=s(e);M(r),t(q,d.currentValue)},G=()=>{if(a.readonly||E.value||v.value)return;const e=Number(P.value)||0,r=s(e,-1);M(r),t(q,d.currentValue)},K=(e,r)=>{const{max:o,min:c,step:p,precision:y,stepStrictly:B,valueOnClear:z}=a;o<c&&me("InputNumber","min should not be greater than max.");let w=Number(e);if(U(e)||Number.isNaN(w))return null;if(e===""){if(z===null)return null;w=Ne(z)?{min:c,max:o}[z]:z}return B&&(w=k(Math.round(w/p)*p,y)),R(y)||(w=k(w,y)),(w>o||w<c)&&(w=w>o?o:c,r&&t(A,w)),w},M=(e,r=!0)=>{var o;const c=d.currentValue,p=K(e);if(!r){t(A,p);return}c!==p&&(d.userInput=null,t(A,p),t(te,p,c),a.validateEvent&&((o=N==null?void 0:N.validate)==null||o.call(N,"change").catch(y=>Q())),d.currentValue=p)},ae=e=>{d.userInput=e;const r=e===""?null:Number(e);t(q,r),M(r,!1)},oe=e=>{const r=e!==""?Number(e):"";(_(r)&&!Number.isNaN(r)||e==="")&&M(r),d.userInput=null},ue=()=>{var e,r;(r=(e=V.value)==null?void 0:e.focus)==null||r.call(e)},se=()=>{var e,r;(r=(e=V.value)==null?void 0:e.blur)==null||r.call(e)},ie=e=>{t("focus",e)},de=e=>{var r;t("blur",e),a.validateEvent&&((r=N==null?void 0:N.validate)==null||r.call(N,"blur").catch(o=>Q()))};return Ve(()=>a.modelValue,e=>{const r=K(d.userInput),o=K(e,!0);!_(r)&&(!r||r!==o)&&(d.currentValue=o,d.userInput=null)},{immediate:!0}),le(()=>{var e;const{min:r,max:o,modelValue:c}=a,p=(e=V.value)==null?void 0:e.input;if(p.setAttribute("role","spinbutton"),Number.isFinite(o)?p.setAttribute("aria-valuemax",String(o)):p.removeAttribute("aria-valuemax"),Number.isFinite(r)?p.setAttribute("aria-valuemin",String(r)):p.removeAttribute("aria-valuemin"),p.setAttribute("aria-valuenow",d.currentValue||d.currentValue===0?String(d.currentValue):""),p.setAttribute("aria-disabled",String(E.value)),!_(c)&&c!=null){let y=Number(c);Number.isNaN(y)&&(y=null),t(A,y)}}),we(()=>{var e,r;const o=(e=V.value)==null?void 0:e.input;o==null||o.setAttribute("aria-valuenow",`${(r=d.currentValue)!=null?r:""}`)}),h({focus:ue,blur:se}),(e,r)=>(I(),$("div",{class:Y([n(b).b(),n(b).m(n(S)),n(b).is("disabled",n(E)),n(b).is("without-controls",!e.controls),n(b).is("controls-right",n(m))]),onDragstart:r[1]||(r[1]=O(()=>{},["prevent"]))},[e.controls?J((I(),$("span",{key:0,role:"button","aria-label":n(C)("el.inputNumber.decrease"),class:Y([n(b).e("decrease"),n(b).is("disabled",n(v))]),onKeydown:D(G,["enter"])},[u(n(ee),null,{default:f(()=>[n(m)?(I(),F(n(Fe),{key:0})):(I(),F(n(Ue),{key:1}))]),_:1})],42,$e)),[[n(ne),G]]):Z("v-if",!0),e.controls?J((I(),$("span",{key:1,role:"button","aria-label":n(C)("el.inputNumber.increase"),class:Y([n(b).e("increase"),n(b).is("disabled",n(l))]),onKeydown:D(L,["enter"])},[u(n(ee),null,{default:f(()=>[n(m)?(I(),F(n(Te),{key:0})):(I(),F(n(Me),{key:1}))]),_:1})],42,Ye)),[[n(ne),L]]):Z("v-if",!0),u(n(re),{id:e.id,ref_key:"input",ref:V,type:"number",step:e.step,"model-value":n(P),placeholder:e.placeholder,readonly:e.readonly,disabled:n(E),size:n(S),max:e.max,min:e.min,name:e.name,label:e.label,"validate-event":!1,onWheel:r[0]||(r[0]=O(()=>{},["prevent"])),onKeydown:[D(O(L,["prevent"]),["up"]),D(O(G,["prevent"]),["down"])],onBlur:de,onFocus:ie,onInput:ae,onChange:oe},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","label","onKeydown"])],34))}});var Je=Be(He,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input-number/src/input-number.vue"]]);const je=ze(Je);const Qe=_e("ChangeConfig",()=>{const i=H({version:"",userAgent:"",sleep:1,maxOnce:20,announceSwitch:!1,announce:"",cookie:"",ssl:!1,prefix:"/admin",debug:!1,password:"",passwordSwitch:!1,getPending:!1,changePending:!1}),h=H(null);return{changeConfigForm:i,changeConfigFormRef:h}}),pn=j({__name:"ChangeConfig",setup(i){const h=Qe(),{changeConfigForm:t,changeConfigFormRef:a}=he(h),V={userAgent:[{required:!0,message:"请输入User_Agent",trigger:"blur"}],announce:[{validator:(v,l,g)=>{t.value.passwordSwitch&&l===""&&g(new Error("请输入公告内容")),g()},trigger:"blur"}],announceSwitch:[{required:!0,message:"请确认开关状态",trigger:"blur"}],debug:[{required:!0,message:"请确认开关状态",trigger:"blur"}],ssl:[{required:!0,message:"请确认开关状态",trigger:"blur"}],prefix:[{required:!0,message:"请输入后台接口后缀",trigger:"blur"}],cookie:[{required:!0,message:"请输入获取列表时的 Cookie",trigger:"blur"}],maxOnce:[{required:!0,message:"请输入批量解析时单次最大解析数量",trigger:"blur"}],sleep:[{required:!0,message:"请输入批量解析时休眠时间(秒)",trigger:"blur"}],password:[{validator:(v,l,g)=>{t.value.passwordSwitch&&l===""&&g(new Error("请输入密码")),g()},trigger:"blur"}],passwordSwitch:[{required:!0,message:"请确认开关状态",trigger:"blur"}]};le(async()=>await d());const d=async()=>{t.value.getPending=!0;const v=await Ie()??"failed";t.value.getPending=!1,v.toString()!=="failed"&&(t.value={...t.value,...v.data})},N=async v=>{if(v&&await v.validate(()=>{})){t.value.changePending=!0;const l=await Se({cookie:t.value.cookie,check:!0})??"failed";if(l.toString()==="failed")return;if(t.value.changePending=!1,l.message!=="cookie校验成功"){W.error("请不要使用包含账户的cookie,直接退出登陆获取一个新cookie");return}W.success("cookie校验成功,不包含账户");const g=await Ce({...t.value})??"failed";if(t.value.changePending=!1,g.toString()==="failed")return;W.success("修改成功"),Ee(t.value.prefix),await d()}};return(v,l)=>{const g=re,m=pe,S=be,E=je,P=ge,k=fe,T=ce;return J((I(),F(k,{ref_key:"changeConfigFormRef",ref:a,model:n(t),rules:V,"label-width":"auto"},{default:f(()=>[u(m,{label:"版本号",prop:"version"},{default:f(()=>[u(g,{disabled:"",modelValue:n(t).version,"onUpdate:modelValue":l[0]||(l[0]=s=>n(t).version=s)},null,8,["modelValue"])]),_:1}),u(m,{label:"DEBUG模式开关",prop:"debug"},{default:f(()=>[u(S,{modelValue:n(t).debug,"onUpdate:modelValue":l[1]||(l[1]=s=>n(t).debug=s),size:"large"},null,8,["modelValue"])]),_:1}),u(m,{label:"强制SSL模式开关",prop:"ssl"},{default:f(()=>[u(S,{modelValue:n(t).ssl,"onUpdate:modelValue":l[2]||(l[2]=s=>n(t).ssl=s),size:"large"},null,8,["modelValue"])]),_:1}),u(m,{label:"公告开关",prop:"announceSwitch"},{default:f(()=>[u(S,{modelValue:n(t).announceSwitch,"onUpdate:modelValue":l[3]||(l[3]=s=>n(t).announceSwitch=s),size:"large"},null,8,["modelValue"])]),_:1}),u(m,{label:"公告内容",prop:"announce"},{default:f(()=>[u(g,{type:"textarea",modelValue:n(t).announce,"onUpdate:modelValue":l[4]||(l[4]=s=>n(t).announce=s),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),u(m,{label:"后台接口前缀",prop:"prefix"},{default:f(()=>[u(g,{modelValue:n(t).prefix,"onUpdate:modelValue":l[5]||(l[5]=s=>n(t).prefix=s),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),u(m,{label:"下载使用的 User_Agent",prop:"userAgent"},{default:f(()=>[u(g,{modelValue:n(t).userAgent,"onUpdate:modelValue":l[6]||(l[6]=s=>n(t).userAgent=s),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),u(m,{label:"批量解析时休眠时间(秒)",prop:"sleep"},{default:f(()=>[u(E,{modelValue:n(t).sleep,"onUpdate:modelValue":l[7]||(l[7]=s=>n(t).sleep=s)},null,8,["modelValue"])]),_:1}),u(m,{label:"批量解析时单次最大解析数量",prop:"maxOnce"},{default:f(()=>[u(E,{modelValue:n(t).maxOnce,"onUpdate:modelValue":l[8]||(l[8]=s=>n(t).maxOnce=s)},null,8,["modelValue"])]),_:1}),u(m,{label:"获取列表时的 Cookie",prop:"cookie"},{default:f(()=>[u(g,{type:"textarea",modelValue:n(t).cookie,"onUpdate:modelValue":l[9]||(l[9]=s=>n(t).cookie=s),modelModifiers:{trim:!0},rows:"5"},null,8,["modelValue"])]),_:1}),u(m,{label:"密码开关",prop:"passwordSwitch"},{default:f(()=>[u(S,{modelValue:n(t).passwordSwitch,"onUpdate:modelValue":l[10]||(l[10]=s=>n(t).passwordSwitch=s),size:"large"},null,8,["modelValue"])]),_:1}),u(m,{label:"密码",prop:"password"},{default:f(()=>[u(g,{modelValue:n(t).password,"onUpdate:modelValue":l[11]||(l[11]=s=>n(t).password=s),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),u(m,{label:" "},{default:f(()=>[u(P,{type:"primary",onClick:l[12]||(l[12]=s=>N(n(a))),loading:n(t).changePending},{default:f(()=>[ye(" 保存 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])),[[T,n(t).getPending]])}}});export{pn as default};
